<?php/* Add this on all pages on top. */set_include_path($_SERVER['DOCUMENT_ROOT'].'/'.PATH_SEPARATOR.$_SERVER['DOCUMENT_ROOT'].'/library/classes/');/*** Standard includes */require_once 'config/database.php';require_once 'config/smarty.php';/*** Check for login */ require_once 'includes/auth.php';/* objects. */require_once 'class/awardcategory.php';require_once 'class/year.php';$awardcategoryObject	= new class_awardcategory();$yearObject 			= new class_year();if (isset($_GET['code']) && trim($_GET['code']) != '') {		$code = trim($_GET['code']);		$awardcategoryData = $awardcategoryObject->getByCode($code);	if($awardcategoryData) {		$smarty->assign('awardcategoryData', $awardcategoryData);	} else {		header('Location: /awards/awardcategory/');		exit;			}}$yearpairs = $yearObject->pairs();if($yearpairs) $smarty->assign('yearpairs', $yearpairs);/* Check posted data. */if(count($_POST) > 0) {	$errorArray		= array();	$data 				= array();	$formValid		= true;	$success			= NULL;		if(isset($_POST['awardcategory_name']) && trim($_POST['awardcategory_name']) == '') {		$errorArray['awardcategory_name'] = 'Category name required';		$formValid = false;			}		if(isset($_POST['year_code']) && trim($_POST['year_code']) == '') {		$errorArray['year_code'] = 'Year of the awards required';		$formValid = false;			}		if(count($errorArray) == 0 && $formValid == true) {		$data 	= array();							$data['awardcategory_name']	= trim($_POST['awardcategory_name']);						$data['year_code']			= trim($_POST['year_code']);					if(isset($awardcategoryData)) {			/*Update. */			$where		= $awardcategoryObject->getAdapter()->quoteInto('awardcategory_code = ?', $awardcategoryData['awardcategory_code']);			$success	= $awardcategoryObject->update($data, $where);		} else {			$success	= $awardcategoryObject->insert($data);					}				if(count($errorArray) == 0) {			header('Location: /awards/category/');				exit;				}	}		/* if we are here there are errors. */	$smarty->assign('errorArray', $errorArray);	}$smarty->display('awards/category/details.tpl');?>